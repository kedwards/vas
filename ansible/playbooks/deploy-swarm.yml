---
- name: setup pre-requisites on non-admin nodes
  hosts: all !admins
  become: yes
  roles:
    - create-sudo-user
    - install-modules
    - configure-hostsname

#- name: setup docker user on admin nodes
#  hosts: admins
#  gather_facts: false
#  become: yes
#  roles:
#   - configure-admin

- name: configure swarm nodes
  hosts: swarm_*
  become: yes
  roles:
    - copy-keys
    - docker-installation
    - docker-swarm-init
    - gluster

- name: install & configure HA Proxy
  hosts: proxy_nodes[0]
  become: yes
  roles:
    - haproxy

